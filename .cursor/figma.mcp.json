{
    "description": "Webflow Optimize Enterprise project context for Dermalogica. Ensures production-ready, conversion-optimized JavaScript and CSS snippets align with holdout policy, brand standards, and Shopify/GA4/Ads tracking. Uses the shipping estimate test as a gold standard pattern.",
    "rules": [
      "➊ **Always use a self-executing anonymous function (() => { ... })** for standalone test logic. Wrap all variations inside this pattern to prevent global leaks.",
      "➋ **Use direct DOM manipulation with standard APIs:** `document.querySelector`, `querySelectorAll`, `createElement`, `replaceWith`, `appendChild`, `setProperty`. This is preferred over frameworks.",
      "➌ **Write clear helper functions in-scope:** For example, `formatDate`, `getDateRangeCopy`, `createEstimateDiv` to keep test logic modular and readable.",
      "➍ **Observe dynamic elements:** Use `MutationObserver` to handle elements injected by AJAX or cart updates, especially on Shopify or Fenix-powered EDD widgets.",
      "➎ **Use meaningful class names:** Prefix all test-specific classes with `wf-` (e.g., `wf-shipping-estimate`). Use BEM-style modifiers (`&--cart`) if needed.",
      "➏ **Embed CSS with proper scope:** For Webflow Optimize, output a `<style>` block inline inside your snippet if needed, and use unique `wf-` or `.i-` prefixes to avoid theme conflicts.",
      "➐ **Precondition expressions must be strict:** Use a single-line condition to gate the test, e.g., `document.querySelector('.fenix-pdp-wrapper') !== null`. Evaluate in the console: `true` on the target page, `false` elsewhere.",
      "➑ **Holdout policy:** Respect the 20% holdout group. Never expose experiences to holdout visitors. Validate your split logic aligns with `Holdout Group.txt`.",
      "➒ **Performance:** Optimize for speed. Keep updates under 20ms paint time. Use `MutationObserver` only when truly needed to reduce flicker and jank.",
      "➓ **GA4 + Shopify:** Never duplicate conversion events. Let native Shopify stream data for product, cart, and checkout events. GA4 auto-syncs with Google Ads for remarketing.",
      "⓫ **Visuals:** Follow Dermalogica brand fundamentals: neutral greys, clinical styling, pro-grade tone. No beauty clichés. Use text like 'Get it between… with Free Shipping' to reinforce urgency and benefit — no discount language.",
      "⓬ **Example:** Use the provided shipping estimate test as a gold standard. It includes a self-executing function, helper functions, inline copy logic, element replacement, `MutationObserver`, and scoped CSS classes that match Webflow Optimize standards."
    ],
    "examples": [
      "```js\n(() => {\n  const formatDate = (date) => date.toLocaleDateString(undefined, { weekday: 'short', month: 'short', day: 'numeric' });\n  const getDateRangeCopy = () => { const now = new Date(); const start = new Date(now); const end = new Date(now); start.setDate(start.getDate() + 3); end.setDate(end.getDate() + 5); return `Get it between <strong>${formatDate(start)} - ${formatDate(end)}</strong> with Free Shipping`; };\n  const createEstimateDiv = () => { const div = document.createElement('div'); div.className = 'wf-shipping-estimate wf-shipping-estimate--cart'; div.innerHTML = getDateRangeCopy(); return div; };\n  const pdpEl = document.querySelector('.fenix-pdp-wrapper');\n  if (pdpEl) { pdpEl.style.setProperty('display', 'block', 'important'); const newDiv = document.createElement('div'); newDiv.className = 'wf-shipping-estimate'; newDiv.innerHTML = getDateRangeCopy(); pdpEl.replaceWith(newDiv); }\n  const updateCartContent = () => { document.querySelectorAll('.fenix-delivery-estimate-cart').forEach(el => { el.innerHTML = getDateRangeCopy(); el.className = 'wf-shipping-estimate wf-shipping-estimate--cart'; }); document.querySelectorAll('.cloned_fenix_message.mobile').forEach(clone => { if (!clone.querySelector('.wf-shipping-estimate--cart')) { const newDiv = createEstimateDiv(); clone.innerHTML = ''; clone.appendChild(newDiv); } }); };\n  updateCartContent();\n  const observer = new MutationObserver(updateCartContent);\n  observer.observe(document.body, { childList: true, subtree: true });\n})();\n```",
      "```css\n.wf-shipping-estimate { font-size: 14px; line-height: 24px; }\n.wf-shipping-estimate--cart { font-size: 16px; }\n.wf-shipping-estimate strong { font-weight: bold; }\n.cart__blocks .text-right { display: none !important; }\n.cloned_fenix_message { margin-bottom: 16px !important; }\n.product .wf-shipping-estimate--cart { display: none !important; }\n```"
    ]
  }
  